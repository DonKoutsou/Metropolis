[gd_scene load_steps=23 format=2]

[ext_resource path="res://Scenes/Env_Assets/SandParticles.tscn" type="PackedScene" id=1]
[ext_resource path="res://Scenes/Env_Assets/Clouds.tscn" type="PackedScene" id=2]
[ext_resource path="res://Scenes/Env_Assets/Rain.tscn" type="PackedScene" id=3]
[ext_resource path="res://Scripts/Clouds.cs" type="Script" id=4]
[ext_resource path="res://Scripts/WorldParticleManager.cs" type="Script" id=5]
[ext_resource path="res://Scenes/World/SunMoonPivot.tscn" type="PackedScene" id=6]
[ext_resource path="res://Assets/Clouds/Textures/smoke_07.png" type="Texture" id=7]
[ext_resource path="res://Assets/Sounds/WindSound.mp3" type="AudioStream" id=8]
[ext_resource path="res://Scripts/WorldSoundManager.cs" type="Script" id=9]
[ext_resource path="res://Assets/Sounds/RainSound.mp3" type="AudioStream" id=10]

[sub_resource type="Curve" id=4]
max_value = 3.0
_data = [ Vector2( 0, 0.9 ), 0.0, 0.0, 0, 0, Vector2( 1, 2.95126 ), 0.0, 0.0, 0, 0 ]

[sub_resource type="Curve" id=5]
max_value = 90.0
_data = [ Vector2( 0, 0 ), 0.0, 0.0, 0, 0, Vector2( 1, 12.509 ), 0.0, 0.0, 0, 0 ]

[sub_resource type="SpatialMaterial" id=2]
render_priority = 1
flags_fixed_size = true
params_diffuse_mode = 4
params_specular_mode = 4
params_blend_mode = 1
params_depth_draw_mode = 1
albedo_color = Color( 1, 0.839216, 0.552941, 1 )
distance_fade_mode = 1
distance_fade_min_distance = 500.0
distance_fade_max_distance = 0.0

[sub_resource type="Curve" id=120]
_data = [ Vector2( 0, 0 ), 0.0, 0.0, 0, 0, Vector2( 0.20032, 1 ), 0.0, 0.0, 0, 0, Vector2( 1, 0 ), 0.0, 0.0, 0, 0 ]

[sub_resource type="CurveTexture" id=121]
curve = SubResource( 120 )

[sub_resource type="ParticlesMaterial" id=1]
emission_shape = 2
emission_box_extents = Vector3( 200, 100, 200 )
direction = Vector3( 0, 0, -1 )
spread = 5.0
gravity = Vector3( 0, 0, 0 )
initial_velocity = 200.0
angular_velocity = 553.85
scale = 0.01
scale_random = 0.05
scale_curve = SubResource( 121 )

[sub_resource type="SphereMesh" id=119]
radius = 0.05
height = 0.1
radial_segments = 4
rings = 1

[sub_resource type="SpatialMaterial" id=112]
render_priority = 1
flags_transparent = true
flags_fixed_size = true
flags_do_not_receive_shadows = true
params_depth_draw_mode = 2
params_billboard_mode = 3
particles_anim_h_frames = 1
particles_anim_v_frames = 1
particles_anim_loop = false
albedo_color = Color( 1, 0.839216, 0.552941, 0.290196 )
albedo_texture = ExtResource( 7 )

[sub_resource type="Curve" id=113]
_data = [ Vector2( 0, 1 ), 0.0, 0.0, 0, 0, Vector2( 1, 0 ), 0.0, 0.0, 0, 0 ]

[sub_resource type="CurveTexture" id=117]
width = 512
curve = SubResource( 113 )

[sub_resource type="ParticlesMaterial" id=114]
trail_size_modifier = SubResource( 117 )
emission_shape = 2
emission_box_extents = Vector3( 5000, 10, 5000 )
direction = Vector3( 0, 0, -1 )
spread = 1.41
gravity = Vector3( 0, 0, 0 )
initial_velocity = 969.33
angular_velocity = 10.0
angular_velocity_random = 1.0
linear_accel_random = 0.35
tangential_accel_random = 1.0
angle_random = 1.0
scale = 0.5
hue_variation = 1.0
hue_variation_random = 1.0

[sub_resource type="QuadMesh" id=115]
size = Vector2( 5, 5 )

[node name="WorldParticleManager" type="Spatial"]
script = ExtResource( 5 )

[node name="Clouds" parent="." instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 5000, 0 )
script = ExtResource( 4 )
CloudHeight = 4000.0

[node name="SunMoonPivot" parent="." instance=ExtResource( 6 )]

[node name="WindAllignedParticles" type="Spatial" parent="."]

[node name="Rain" parent="WindAllignedParticles" instance=ExtResource( 3 )]
PitchScaleCurve = SubResource( 4 )
SoundScaleCurve = SubResource( 5 )

[node name="SandParticles" parent="WindAllignedParticles" instance=ExtResource( 1 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 100, 200 )
material_override = SubResource( 2 )
cast_shadow = 0
visibility_aabb = AABB( -1163.96, -976.849, -1014.37, 2327.92, 1953.7, 2028.74 )
local_coords = false
draw_order = 2
process_material = SubResource( 1 )
draw_pass_1 = SubResource( 119 )
__meta__ = {
"apply_volumetrics": false
}

[node name="Particles" type="Particles" parent="WindAllignedParticles"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 118.329, 2500 )
material_override = SubResource( 112 )
cast_shadow = 0
generate_lightmap = false
amount = 5
lifetime = 15.0
speed_scale = 5.0
visibility_aabb = AABB( -3825.97, 0, -4096, 7651.96, 3042.07, 8192 )
local_coords = false
draw_order = 2
process_material = SubResource( 114 )
draw_pass_1 = SubResource( 115 )

[node name="WorldSoundManager" type="Spatial" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.135783, 0 )
script = ExtResource( 9 )

[node name="Rain" type="AudioStreamPlayer" parent="WorldSoundManager"]
stream = ExtResource( 10 )
autoplay = true
mix_target = 1
bus = "Weather"

[node name="Enviroment" type="AudioStreamPlayer" parent="WorldSoundManager"]
stream = ExtResource( 8 )
volume_db = -3.0
autoplay = true
mix_target = 1
bus = "Weather"
